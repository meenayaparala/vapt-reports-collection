
# 1. Username Enumeration via Different Responses

## 2. CVSS Score

**CVSS v3.1 Base Score: 6.5 (Medium)**
**CWE-204: Response Discrepancy Information Leak**

---

## 3. OWASP Top 10 Reference

* **A07:2021 – Identification and Authentication Failures**
* **A01:2021 – Broken Access Control** (due to potential chaining with authentication bypass)

---

## 4. Description of Vulnerability

This vulnerability allows an attacker to **enumerate valid usernames** based on differences in the application's responses to failed login attempts.

The login form responds with **different error messages** depending on whether the username is valid or not. This subtle difference can be detected programmatically using a brute-force or automation tool such as **Burp Intruder**, enabling attackers to extract a list of valid usernames.

---

## 5. Detailed Explanation of What We Performed

We used **Burp Suite** to send multiple login requests by iterating through a list of usernames. The application gave two distinct responses:

* `Invalid username` when the username doesn't exist.
* `Incorrect password` when the username exists.

This discrepancy was used to identify valid usernames and later brute-force their passwords.

---

## 6. Step-by-Step Procedure

### Step 1: Capture the Login Request

1. Navigate to the login page on the lab website.
2. Enter any **invalid username and password**.
3. In **Burp Suite**, go to **Proxy > HTTP History** and locate the `POST /login` request.
4. Right-click and **send it to Intruder**.

---

### Step 2: Identify Valid Usernames via Intruder

5. In **Intruder**, the `username` parameter is automatically marked with `§` symbols.
6. Under **Attack type**, select `Sniper`.
7. In the **Payloads** tab:

   * Choose **Simple list** as the payload type.
   * Paste a list of common usernames (e.g., `administrator`, `carlos`, `wiener`, etc.).
8. Leave the password static (e.g., `randompass`).
9. Click **Start Attack**.

> 💡 **Result:** One of the usernames results in a **longer response length** or a **different status code** and shows `Incorrect password`, indicating that the username is valid.

---

### Step 3: Brute-force the Password for the Identified Username

10. Back in **Intruder**, click **Clear §**.
11. Modify the request like this:

```
username=identified-user&password=§invalid-password§
```

12. Add common passwords to the payload list.
13. Start a new attack.

> 💡 **Result:** One of the responses has a **status code 302** (redirect), indicating successful login.

---

## 7. Impact of the Vulnerability

* **Username Enumeration** allows attackers to confirm valid users.
* Can be used in combination with **credential stuffing** or **brute-force attacks**.
* **Increased risk** for high-privilege accounts like `administrator`.

---

## 8. Recommendations and Mitigations

* Return a **generic error message** regardless of whether the username or password is incorrect (e.g., `Invalid username or password.`).
* Implement **rate-limiting** and **account lockout mechanisms**.
* Use **multi-factor authentication (MFA)** to prevent brute-force compromise.

---

## 9. References

* [OWASP Authentication Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)
* [PortSwigger Lab – Username Enumeration via Different Responses](https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-different-responses)
* [CWE-204: Response Discrepancy](https://cwe.mitre.org/data/definitions/204.html)

---

## 10. Proof of Concept

### 🔐 Sample Request for Username Discovery

```http
POST /login HTTP/1.1
Host: vulnerable-lab
Content-Type: application/x-www-form-urlencoded
Content-Length: 34

username=admin&password=randompass
```

### 🛑 Server Response (Non-existent user)

```
HTTP/1.1 200 OK
Invalid username
```

### ✅ Server Response (Valid user, wrong password)

```
HTTP/1.1 200 OK
Incorrect password
```

### 🎯 Final Login

Once both a valid **username** and **password** are found, log in and confirm successful authentication.


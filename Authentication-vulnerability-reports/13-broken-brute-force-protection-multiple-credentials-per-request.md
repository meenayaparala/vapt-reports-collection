
# 13. Login JSON Password Array Injection

## 2. CVSS Score

**CVSS v3.1 Base Score: 7.5 (High)**
**CWE-307: Improper Restriction of Excessive Authentication Attempts**
**CWE-307: Improper Authentication**

---

## 3. OWASP Top 10 Reference

* **A01:2021 – Broken Access Control**
* **A07:2021 – Identification and Authentication Failures**

---

## 4. Description of Vulnerability

The login endpoint accepts credentials in JSON format and incorrectly processes the password field when it is submitted as an array of multiple passwords rather than a single string. This allows an attacker to submit multiple passwords in one request, bypassing typical brute-force protections and logging in successfully if any password in the array is valid.

---

## 5. Detailed Explanation of What We Performed

* Intercepted a valid login POST request with JSON data containing `"username"` and `"password"` fields.
* Modified the `"password"` field to be an array containing multiple candidate passwords.
* Sent the modified request via Burp Repeater.
* The server responded with a 302 redirect, indicating a successful login.
* Followed the redirect to confirm that we were logged in as the targeted user.
* Accessed the user account page to verify successful exploitation and solved the lab.

---

## 6. Step-by-Step Procedure

### Step 1: Intercept Login Request

1. Log in to your own account to capture a valid login request.
2. In Burp Proxy, find the POST `/login` request with JSON payload:

   ```json
   {
     "username": "carlos",
     "password": "correctpassword"
   }
   ```
3. Send this request to Burp Repeater.

---

### Step 2: Modify Password Field to an Array

4. Replace the `"password"` value with an array of candidate passwords:

   ```json
   "password": [
     "123456",
     "password",
     "qwerty",
     "letmein",
     "correctpassword"
   ]
   ```
5. Send the modified request.

---

### Step 3: Observe Response and Confirm Login

6. The server responds with HTTP 302 Found, redirecting to the user dashboard.
7. Right-click the request in Burp Repeater and choose **Show response in browser**.
8. Confirm that the browser loads the user dashboard logged in as Carlos.

---

### Step 4: Solve the Lab

9. Access the **My account** page to complete the lab.

---

## 7. Impact of the Vulnerability

* Allows attackers to bypass traditional login protections and brute-force limitations by submitting multiple passwords in a single request.
* Enables unauthorized access to user accounts without triggering rate-limiting or account lockout.
* Can be leveraged for large-scale automated attacks.

---

## 8. Recommendations and Mitigations

* Ensure the login API strictly validates the password field as a single string value.
* Reject login requests with password fields that are arrays or other unexpected types.
* Implement proper rate-limiting and account lockout mechanisms.
* Sanitize and validate all incoming JSON payloads thoroughly.
* Monitor for anomalous login request patterns.

---

## 9. References

* [OWASP API Security Top 10 - 2019](https://owasp.org/www-project-api-security/)
* [OWASP Authentication Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)
* [PortSwigger Labs – Login with JSON Array Passwords](https://portswigger.net/web-security/authentication/json-login-array)


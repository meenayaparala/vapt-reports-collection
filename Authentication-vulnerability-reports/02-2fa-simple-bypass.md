
# 2. 2FA Simple Bypass

## 2. CVSS Score

**CVSS v3.1 Base Score: 6.5 (Medium)**
**CWE-287: Improper Authentication**

---

## 3. OWASP Top 10 Reference

* **A07:2021 – Identification and Authentication Failures**
* **A05:2021 – Security Misconfiguration**

---

## 4. Description of Vulnerability

This lab demonstrates a **logical flaw** in the two-factor authentication (2FA) process, allowing a user to bypass the second authentication step simply by navigating directly to a protected endpoint after submitting valid login credentials.

The vulnerability exists because **authorization checks are not properly enforced on the 2FA verification endpoint**. While the application prompts for a second authentication factor (a verification code), it does not validate whether 2FA was completed before allowing access to sensitive pages.

---

## 5. Detailed Explanation of What We Performed

The vulnerability was exploited by:

* Logging in with the victim’s credentials.
* When prompted to enter a 2FA verification code, the attacker directly accessed the **authenticated user page** (e.g., `/my-account`) via a **URL manipulation**.
* The server granted access without enforcing 2FA verification, revealing the account information and solving the lab.

This highlights a **flawed implementation of session access control** that trusts partially authenticated sessions.

---

## 6. Step-by-Step Procedure

### Step 1: Log in to Your Own Account

1. Navigate to the login page.
2. Enter your own account credentials.
3. Access your **email inbox** via the **Email client** button.
4. Enter the **2FA code** received via email to complete the login.

---

### Step 2: Locate Target Account Page

5. After logging in, go to your **account page** (typically `/my-account`) and **note the full URL** for later use.
6. Click **"Log out"** to return to the login screen.

---

### Step 3: Bypass 2FA as the Victim

7. Log in using the **victim’s credentials**.
8. When prompted for the **2FA code**, **don’t enter anything**.
9. Instead, **manually change the URL** to the account page you noted earlier (e.g., `/my-account`).
10. Hit **Enter** to load the page.

---

## 7. Impact of the Vulnerability

* **Bypassing 2FA security** measures completely.
* Unauthorized access to sensitive user information.
* **Breaks user session trust model**, allowing attackers to act as authenticated users.
* Violates compliance and security policies for user authentication.

---

## 8. Recommendations and Mitigations

* **Enforce strict access control**: Validate completion of all authentication steps before allowing access to protected resources.
* **Implement session flags**: Ensure that session tokens are only marked as authenticated after successful 2FA completion.
* **Use server-side checks** on every sensitive route to verify that 2FA has been satisfied.
* **Penetration test authentication flows** to discover similar logic flaws.

---

## 9. References

* [OWASP Authentication Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)
* [PortSwigger Web Security Academy – Authentication Labs](https://portswigger.net/web-security/authentication)

---

## 10. Proof of Concept

### Victim Login Credentials (provided by the lab):

```
Username: wiener  
Password: peter
```

### Exploit Steps:

1. Go to login page → Enter victim credentials.
2. At 2FA code prompt, change the URL from:

   ```
   https://<lab-id>.web-security-academy.net/login2
   ```

   to:

   ```
   https://<lab-id>.web-security-academy.net/my-account
   ```
3. The **account page loads without requiring the 2FA code**, confirming the bypass.


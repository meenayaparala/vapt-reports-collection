
# 03. Password Reset Broken Logic

## 2. CVSS Score

**CVSS v3.1 Base Score: 7.4 (High)**
**CWE-640: Weak Password Recovery Mechanism for Forgotten Password**

---

## 3. OWASP Top 10 Reference

* **A07:2021 – Identification and Authentication Failures**
* **A01:2021 – Broken Access Control**

---

## 4. Description of Vulnerability

This lab demonstrates a logic flaw in the **password reset functionality**. The application allows a user to reset another user's password **without proper validation**, enabling an attacker to take over any account by initiating a password reset request and completing it using a fixed or predictable token.

This kind of vulnerability stems from **missing or improper verification of the reset request** (e.g., matching email/token/user context), allowing unauthorized password changes.

---

## 5. Detailed Explanation of What We Performed

We exploited a flaw in how the password reset flow is implemented. The server does not ensure the password reset token or flow is tied securely to the correct user account. By manipulating requests or reusing/resetting endpoints, we reset the password for the **target user account**, effectively hijacking it.

---

## 6. Step-by-Step Procedure

> *Note: The following steps are based on typical password reset exploitation patterns from the lab.*

### Step 1: Go to the "Forgot Password" Page

1. Click **“Forgot password?”** on the login page.
2. Enter the **victim's username** (e.g., `carlos`) and submit the form.

---

### Step 2: Intercept and Manipulate Reset Flow

3. Observe the password reset behavior in **Burp Suite's Proxy > HTTP history**.
4. Depending on the lab, intercept the tokenized link or reset form submission and notice one of the following:

   * The server **fails to validate the token properly**.
   * The reset functionality can be accessed **without verifying identity or token**.
   * A **predictable or hardcoded token** is reused.

---

### Step 3: Reset the Victim's Password

5. Submit a request to reset the victim's password using a guessed/predictable token or by directly accessing the password reset form with the victim's username.

---

### Step 4: Log In as the Victim

6. Use the newly set password and the victim's username (e.g., `carlos`) to log in.

7. Access the **My Account** page to verify account takeover and solve the lab.

---

## 7. Impact of the Vulnerability

* **Full Account Takeover** of other users without needing prior credentials.
* **Loss of confidentiality, integrity, and availability** of user data.
* Can lead to privilege escalation depending on the compromised user’s role.

---

## 8. Recommendations and Mitigations

* **Validate password reset tokens** strictly – bind them to the user and expire after a short time.
* Implement **rate-limiting and brute-force protections**.
* Always require **token verification** for resetting passwords.
* Use **cryptographically strong random tokens** for password reset flows.

---

## 9. References

* [OWASP Forgot Password Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html)
* [OWASP Authentication Best Practices](https://owasp.org/www-project-top-ten/)

---

## 10. Proof of Concept

### Vulnerable Flow:

```http
POST /forgot-password HTTP/1.1
Host: <lab-id>.web-security-academy.net
...
username=carlos
```

**Result**: The reset request goes through without verifying the token properly.

---

### Reset Password:

```http
POST /reset-password HTTP/1.1
Host: <lab-id>.web-security-academy.net
...
username=carlos&new-password=hacked123
```

### Log in as Victim:

* Username: `carlos`
* Password: `hacked123`

**Outcome**: Successfully logged in as `carlos` without knowing the original password.


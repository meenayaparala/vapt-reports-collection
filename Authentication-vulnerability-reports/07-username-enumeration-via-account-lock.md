
# 07. Account Lockout Enumeration and Password Brute Force via Burp Intruder

## 2. CVSS Score

**CVSS v3.1 Base Score: 6.5 (Medium)**
**CWE-307: Improper Restriction of Excessive Authentication Attempts**

---

## 3. OWASP Top 10 Reference

* **A07:2021 – Identification and Authentication Failures**
* **A05:2021 – Security Misconfiguration**

---

## 4. Description of Vulnerability

This lab explores account lockout enumeration by exploiting **response length differences** and error messages during login attempts. Using Burp Intruder’s **Cluster Bomb** and **Sniper** attacks, an attacker can identify valid usernames and brute force passwords even in the presence of lockout protections.

---

## 5. Detailed Explanation of What We Performed

By sending multiple usernames with repeated password attempts, the server responds with varying error messages and response lengths depending on whether the username exists and if the account is locked.

After identifying a valid username by observing longer response lengths and specific error messages, we performed a password brute force attack on that username using Sniper mode. We monitored the responses to detect a successful login indicated by the absence of an error message.

---

## 6. Step-by-Step Procedure

### Step 1: Identify Valid Username via Cluster Bomb Attack

1. Intercept a login POST request with invalid credentials.
2. Send the request to Burp Intruder.
3. Select **Cluster Bomb** attack type.
4. Add a payload position on the **username** parameter.
5. Add a **blank payload position** at the end of the request body (click **Add §**).
6. The request should resemble:
   `username=§invalid-username§&password=example§§`
7. For the first payload (username), add a list of candidate usernames.
8. For the second payload, select **Null payloads** and generate 5 payloads to repeat each username 5 times.
9. Start the attack.
10. Analyze responses; a username with **longer responses** and the error message
    *“You have made too many incorrect login attempts.”* indicates a valid locked account.

---

### Step 2: Brute Force Password with Sniper Attack

11. Send the login POST request to Intruder again.
12. Select **Sniper** attack type.
13. Set the username parameter to the identified valid username.
14. Add a payload position to the **password** parameter.
15. Add a list of candidate passwords.
16. Create a **grep extraction rule** for error messages.
17. Start the attack.
18. Look for responses **without the error message**, indicating a successful login.
19. Note the successful password.

---

### Step 3: Complete the Lab

20. Wait for approximately 1 minute to allow the account lockout to reset.
21. Log in with the identified username and password.
22. Access the user account page to solve the lab.

---

## 7. Impact of the Vulnerability

* Enables **user enumeration** by response length and error message differences.
* Allows attackers to brute force passwords despite lockout protections.
* Increases risk of **account compromise** and unauthorized access.

---

## 8. Recommendations and Mitigations

* Implement consistent response lengths and generic error messages to prevent user enumeration.
* Use progressive delays or CAPTCHA on failed login attempts.
* Limit brute force attempts using IP and account-based throttling.
* Implement multi-factor authentication to mitigate risk.

---

## 9. References

* [OWASP Authentication Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)
* [PortSwigger Lab: Account lockout enumeration and password brute force](https://portswigger.net/web-security/authentication/password-based/lab-account-lockout-enumeration)

---

## 10. Proof of Concept

### Cluster Bomb Attack Payload Example:

```http
POST /login HTTP/1.1
Content-Type: application/x-www-form-urlencoded
...

username=§username§&password=example§§
```

* Payload 1 (username): list of usernames
* Payload 2 (password): null payload repeated 5 times per username

### Sniper Attack Payload Example:

```http
POST /login HTTP/1.1
Content-Type: application/x-www-form-urlencoded
...

username=valid-user&password=§password§
```

* Payload (password): list of candidate passwords

